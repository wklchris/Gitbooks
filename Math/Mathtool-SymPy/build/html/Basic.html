

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. SymPy 基础 &mdash; Sympy 笔记 0.1 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/rtd-revised.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="2. 微积分与极限" href="Calculus.html" />
    <link rel="prev" title="《SymPy 笔记》前言" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Sympy 笔记
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
            
            <a href="https://wklchris.github.io/Gitbooks/homepage/" style="margin:0pt 2pt">
              · Site Homepage ·
            </a>
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. SymPy 基础</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">1.1. 符号</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">1.2. 表达式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">1.2.1. 表达式代入值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evalf">1.2.2. evalf 函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sympify-lambdify">1.2.3. sympify 与 lambdify 函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id4">1.3. 等式与恒等判断</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">1.4. ^ 与 / 的慎重使用*</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">1.5. 展开与化简</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">1.5.1. 多项式的展开与因式分解</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">1.5.2. 分式的分解与化简</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">1.5.3. 三角函数的展开与化简</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">1.5.4. 多项式的合并同类项</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">1.5.5. 其他展开与化简</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">1.6. 特殊运算符与符号</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Calculus.html">2. 微积分与极限</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Calculus.html#id2">2.1. 导数</a></li>
<li class="toctree-l2"><a class="reference internal" href="Calculus.html#id3">2.2. 积分</a></li>
<li class="toctree-l2"><a class="reference internal" href="Calculus.html#id4">2.3. 极限</a></li>
<li class="toctree-l2"><a class="reference internal" href="Calculus.html#taylor">2.4. 高阶项与 Taylor 展开</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Solver.html">3. 解方程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Solver.html#id2">3.1. 通用求解器</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solver.html#id3">3.2. 重根</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solver.html#id4">3.3. 线性方程组</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solver.html#id5">3.4. 非线性方程组</a></li>
<li class="toctree-l2"><a class="reference internal" href="Solver.html#id6">3.5. 微分方程</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sympy 笔记</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>1. SymPy 基础</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Basic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="Calculus.html" class="btn btn-neutral float-right" title="2. 微积分与极限" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="《SymPy 笔记》前言" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sympy">
<h1>1. SymPy 基础<a class="headerlink" href="#sympy" title="永久链接至标题">¶</a></h1>
<p>如何安装 SymPy 请参考官方文档．下面只介绍 SymPy 的用法．</p>
<p>在本笔记中，SymPy 以贪心的方式加载（这也是官方默认的加载方式）：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>本笔记使用 Sphinx 的 <cite>IPython.sphinxext.ipython_directive</cite> 插件来实现 Python 代码执行．</p>
<div class="section" id="id1">
<h2>1.1. 符号<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>符号计算的首先需要指明哪些变量是符号，这点与编译编程语言的声明变量有异曲同工之妙：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;y zzz&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gh">Out[4]: </span><span class="go">zzz + 1</span>
</pre></div>
</div>
<p>从上例可以看出，符号与变量名不一定需要对应．</p>
<ul>
<li><p class="first">对于连续字母，可以简写：</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x:z&#39;</span><span class="p">)</span>  <span class="c1"># x, y, z</span>
<span class="gh">Out[5]: </span><span class="go">(x, y, z)</span>

<span class="gp">In [6]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;:d&#39;</span><span class="p">)</span>  <span class="c1"># a, b, c, d</span>
<span class="go">                  Out[6]: (a, b, c, d)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">对于一系列脚标的变量，可以有这些简写：</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x:5&#39;</span><span class="p">)</span>  <span class="c1"># x0, x1, ..., x4</span>
<span class="gh">Out[7]: </span><span class="go">(x0, x1, x2, x3, x4)</span>

<span class="gp">In [8]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x5:10&#39;</span><span class="p">)</span>   <span class="c1"># x5, x6, ..., x9</span>
<span class="go">                             Out[8]: (x5, x6, x7, x8, x9)</span>

<span class="gp">In [9]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x1(:4)&#39;</span><span class="p">)</span> <span class="c1"># x10, x11, x12, x13</span>
<span class="go">                                                          Out[9]: (x10, x11, x12, x13)</span>

<span class="gp">In [10]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x(:c)&#39;</span><span class="p">)</span>  <span class="c1"># xa, xb, xc; Note that &#39;c&#39; is included</span>
<span class="go">                                                                                       Out[10]: (xa, xb, xc)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">声明时指出其他性质：</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># Two real numbers</span>
<span class="gh">Out[11]: </span><span class="go">(a, b)</span>

<span class="gp">In [12]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># Two positive numbers</span>
<span class="go">                Out[12]: (a, b)</span>

<span class="gp">In [13]: </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;f1 g1&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">Function</span><span class="p">)</span>  <span class="c1"># Two functions</span>
<span class="go">                                Out[13]: (f1, g1)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">如果声明的变量含有括号，在声明时请双写括号；如果含逗号、分号或空格，请用反斜杠 <code class="code docutils literal notranslate"><span class="pre">\</span> </code> 逃逸．</p>
</li>
</ul>
</div>
<div class="section" id="id2">
<h2>1.2. 表达式<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>其实上一节中已经展示了表达式的使用：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>这里的 <code class="code docutils literal notranslate"><span class="pre">f</span></code> 就是一个表达式，即数学上的 <img class="math" src="_images/math/1f0a8435ae756af720f25572a196abbc368686d1.svg" alt="f = \sqrt{x} + 1"/> ．</p>
<div class="section" id="id3">
<h3>1.2.1. 表达式代入值<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>注意，对符号对应的变量进行赋值 <strong>不能</strong> 计算出表达式的值：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>

<span class="gp">In [17]: </span><span class="n">f</span>
<span class="gh">Out[17]: </span><span class="go">sqrt(x) + 1</span>
</pre></div>
</div>
<p>这是因为变量 <code class="code docutils literal notranslate"><span class="pre">x</span></code> 的改变已经无法影响符号 <code class="code docutils literal notranslate"><span class="pre">x</span></code> 了．</p>
<p>上述“错误”的操作不仅导致表达式无法计算，而且会在代入值时出现问题．因此，我们需要重新定义变量 <code class="code docutils literal notranslate"><span class="pre">x</span></code> ．如果要计算表达式的值，使用与 Matlab 语法近似的 <code class="code docutils literal notranslate"><span class="pre">subs()</span></code> 函数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>

<span class="go"># Single variable</span>
<span class="gp">In [19]: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gh">Out[19]: </span><span class="go">1 + 2*sqrt(2)</span>

<span class="go"># Multiple variables</span>
<span class="gp">In [20]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [21]: </span><span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gh">Out[21]: </span><span class="go">1 + sqrt(3)</span>

<span class="gp">In [22]: </span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span>

<span class="gp">In [23]: </span><span class="n">h</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
<span class="gh">Out[23]: </span><span class="go">x + 8*y**2 + 2*y</span>
</pre></div>
</div>
<p>读者可能注意到，SymPy 还进行了 <img class="math" src="_images/math/7cc3e9a4b565bf4d973727cbe018c10a726a1c3d.svg" alt="\sqrt{8}=2\sqrt{2}"/> 的化简．这也是 SymPy 的有趣之处．</p>
<p>一些注意：</p>
<ol class="arabic">
<li><p class="first">代入值不会改变表达式的内容，除非你显示地将其又赋给该表达式（如 <code class="code docutils literal notranslate"><span class="pre">f=f.subs(x,</span> <span class="pre">8)</span></code>）</p>
</li>
<li><p class="first">代入值可以是另一个表达式：</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">y**2 + sqrt(x + y)</span>

<span class="gp">In [25]: </span><span class="n">g</span>  <span class="c1"># Doesn&#39;t change the original expression</span>
<span class="go">                            Out[25]: sqrt(x) + y**2</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">如果要计算表达式的最终浮点结果，使用 <code class="code docutils literal notranslate"><span class="pre">evalf(subs={x:</span> <span class="pre">xval,</span> <span class="pre">...})</span></code> 的形式．</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [27]: </span><span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gh">Out[27]: </span><span class="go">sqrt(2)</span>

<span class="gp">In [28]: </span><span class="n">g</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="go">                 Out[28]: 1.41421356237310</span>
</pre></div>
</div>
<p>函数 <code class="code docutils literal notranslate"><span class="pre">evalf()</span></code> 在下面介绍．</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="evalf">
<h3>1.2.2. evalf 函数<a class="headerlink" href="#evalf" title="永久链接至标题">¶</a></h3>
<p>函数 <code class="code docutils literal notranslate"><span class="pre">evalf(num,</span> <span class="pre">subs={},</span> <span class="pre">chop=False)</span></code> 可以以浮点形式计算结果．它主要有以下参数：</p>
<ul class="simple">
<li>首参数 <code class="code docutils literal notranslate"><span class="pre">num</span></code> 表示精度，默认是 15 位．</li>
<li>参数 <code class="code docutils literal notranslate"><span class="pre">subs</span></code> 传入一个给变量代入值的字典．</li>
<li>参数 <code class="code docutils literal notranslate"><span class="pre">chop</span></code> 表示是否忽略极小的精度误差．</li>
</ul>
<p>例子：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="gh">Out[29]: </span><span class="go">3.14159265358979</span>

<span class="gp">In [30]: </span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">                          Out[30]: 3.1415926535897932385</span>

<span class="gp">In [31]: </span><span class="n">expr</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>

<span class="gp">In [32]: </span><span class="n">expr</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gh">Out[32]: </span><span class="go">-0.e-124</span>

<span class="gp">In [33]: </span><span class="n">expr</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">chop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">                  Out[33]: 0</span>
</pre></div>
</div>
</div>
<div class="section" id="sympify-lambdify">
<h3>1.2.3. sympify 与 lambdify 函数<a class="headerlink" href="#sympify-lambdify" title="永久链接至标题">¶</a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">sympify(str)</span></code> 函数，可以将字符串转为表达式：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">sympify</span><span class="p">(</span><span class="s2">&quot;x**2 + 1&quot;</span><span class="p">)</span>
<span class="gh">Out[34]: </span><span class="go">x**2 + 1</span>
</pre></div>
</div>
<p>用 <code class="code docutils literal notranslate"><span class="pre">lambdify(sym,</span> <span class="pre">expr,</span> <span class="pre">pkg)</span></code> 函数，可以将表达式转为一个函数．这样做的目的是 SymPy 在大规模代入值计算上的速度不如其他库，比如 NumPy：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">In [36]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="gp">In [37]: </span><span class="n">expr</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [38]: </span><span class="n">f</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>

<span class="gp">In [39]: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gh">Out[39]: </span><span class="go"></span>
<span class="go">array([ 0.0000000e+00,  1.0000000e+00,  1.2246468e-16, -1.0000000e+00,</span>
<span class="go">       -2.4492936e-16])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>1.3. 等式与恒等判断<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>Sympy 中的等式使用 <code class="code docutils literal notranslate"><span class="pre">Eq(LHS,</span> <span class="pre">RHS)</span></code> 来表示．例如，下例表示等式 <img class="math" src="_images/math/5de00cb6f575cb8cf18dc89664cafff698235807.svg" alt="\sin x = 1"/> ：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [40]: </span><span class="n">Eq</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gh">Out[40]: </span><span class="go">Eq(sin(x), 1)</span>
</pre></div>
</div>
<p>恒等判断是个有趣的话题：</p>
<ul class="simple">
<li>连等号“==”只判断两式在形式上是否逐字符相等，不涉及展开、变换等数学上的相等</li>
<li>利用 <code class="code docutils literal notranslate"><span class="pre">simplify(a</span> <span class="pre">-</span> <span class="pre">b)</span></code> ，或者 <code class="code docutils literal notranslate"><span class="pre">a.equals(b)</span></code> ，可以判断两式是否数学意义上相等</li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [42]: </span><span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>

<span class="go"># Symbolically equal</span>
<span class="gp">In [43]: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="gh">Out[43]: </span><span class="go">False</span>

<span class="go"># Mathematically equal</span>
<span class="gp">In [44]: </span><span class="n">simplify</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
<span class="go">               Out[44]: 0</span>

<span class="gp">In [45]: </span><span class="n">a</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">                          Out[45]: True</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>1.4. ^ 与 / 的慎重使用*<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>首先讲 <code class="code docutils literal notranslate"><span class="pre">^</span></code> 符号．这个符号在 SymPy 中不是乘方（乘方使用与 Python 原生一致的 <code class="code docutils literal notranslate"><span class="pre">**</span></code> 符号），而是异或判断．</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="bp">True</span> <span class="o">^</span> <span class="bp">True</span>  <span class="c1"># Xor(True, True)</span>
<span class="gh">Out[46]: </span><span class="go">False</span>
</pre></div>
</div>
<p>其次是除法 <code class="code docutils literal notranslate"><span class="pre">/</span></code> 符号，它是需要慎重对待的运算符．显然，加法和减法不会改变变量类型，比如两个整数相减仍是整型，整数减去浮点数得到浮点数．但是，两个整数相除在 Python 的不同版本中可能并不得到相同的数据类型．</p>
<p>为了避免这一问题，SymPy 将整数相除视作其内置的有理数类型．也建议在 SymPy 中，使用 <code class="code docutils literal notranslate"><span class="pre">Rational(a,b)</span></code> 函数表示整数相除：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="n">x</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Instead of &#39;1/2&#39;</span>
<span class="gh">Out[47]: </span><span class="go">x + 1/2</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>1.5. 展开与化简<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>SymPy 有一个通用的化简函数 <code class="code docutils literal notranslate"><span class="pre">simplify(expr)</span></code> ，但并不推荐，因为较慢．</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [48]: </span><span class="n">simplify</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[48]: </span><span class="go">1</span>
</pre></div>
</div>
<div class="section" id="id7">
<h3>1.5.1. 多项式的展开与因式分解<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>多项式形式的因式分解在某些角度看像是“化简”，但 <code class="code docutils literal notranslate"><span class="pre">simplify()</span></code> 函数不能完成这一工作．请使用 <code class="code docutils literal notranslate"><span class="pre">factor</span></code> ．与之相反的功能，即多项式展开，可以使用 <code class="code docutils literal notranslate"><span class="pre">expand</span></code> 函数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[49]: </span><span class="go">(x + y)**2</span>

<span class="gp">In [50]: </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">                    Out[50]: x**2 + 2*x*y + y**2</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>1.5.2. 分式的分解与化简<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>分式的部分分式分解使用 <code class="code docutils literal notranslate"><span class="pre">apart</span></code> 函数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">expr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="gp">In [52]: </span><span class="n">apart</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gh">Out[52]: </span><span class="go">-1/(x + 1) + 1/x</span>
</pre></div>
</div>
<p>对于可约分的分式，使用 <code class="code docutils literal notranslate"><span class="pre">cancel</span></code> 函数化简速度更快：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [54]: </span><span class="n">cancel</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="gh">Out[54]: </span><span class="go">(x**2 + x + 1)/(x + 1)</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>1.5.3. 三角函数的展开与化简<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">trigsimp</span></code> 与 <code class="code docutils literal notranslate"><span class="pre">expand_trig</span></code> 函数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [55]: </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gh">Out[55]: </span><span class="go">sin(2*x)</span>

<span class="gp">In [56]: </span><span class="n">expand_trig</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">                  Out[56]: 2*sin(x)*cos(x)</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>1.5.4. 多项式的合并同类项<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p>函数 <code class="code docutils literal notranslate"><span class="pre">collect(expr,</span> <span class="pre">sym)</span></code> 可以将表达式按 <code class="code docutils literal notranslate"><span class="pre">sym</span></code> 变量的各次项来合并系数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="n">expr</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y</span>

<span class="gp">In [58]: </span><span class="n">collect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gh">Out[58]: </span><span class="go">x**2*y + x*(y + 1)</span>

<span class="gp">In [59]: </span><span class="n">collect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">                            Out[59]: x + y*(x**2 + x)</span>
</pre></div>
</div>
<p>可以利用 <code class="code docutils literal notranslate"><span class="pre">coef(sym,</span> <span class="pre">n)</span></code> 来计算对应变量的 <img class="math" src="_images/math/5ea9341380737b3580e612da7d472e9911e17b8a.svg" alt="n"/> 次项的系数：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">collect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[60]: </span><span class="go">y</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>1.5.5. 其他展开与化简<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>其他的展开与化简还包括幂函数（powsimp, expand_power_exp/expand_power_base），对数函数（expand_log, logcombine）．同时，一些特殊的函数（如 <img class="math" src="_images/math/b346bd3875ea69f9f620ab46f449d7c2bf906edf.svg" alt="\Gamma(x)"/> ）也有基于其的化简函数．具体的内容请参考官方手册．</p>
</div>
</div>
<div class="section" id="id12">
<h2>1.6. 特殊运算符与符号<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h2>
<p>特殊符号有：</p>
<ul class="simple">
<li>无穷 <img class="math" src="_images/math/5bc0648850873e96aaabe37f58129c79864aaf74.svg" alt="\infty"/> 在 Sympy 中用两个小写的字母 o 表示</li>
</ul>
<p>其他运算符包括：</p>
<ul class="simple">
<li>阶乘 <img class="math" src="_images/math/378c29c2fcdd99b21995192b914fc4cc77062c1f.svg" alt="n!"/></li>
<li>排列组合 <img class="math" src="_images/math/5a2c1fc963af32a562e8db3a1faf8d22ed0e2b2d.svg" alt="\binom{n}{k}=\mathrm{C}^k_n"/></li>
<li>伽马函数 <img class="math" src="_images/math/6d3b258a77007b2c8bd719562358f79eca9b54cc.svg" alt="\Gamma(x) = \int_0^\infty t^{x-1}\ue^{-t}\ud t"/></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [61]: </span><span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n k&#39;</span><span class="p">)</span>

<span class="gp">In [62]: </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gh">Out[62]: </span><span class="go">factorial(n)</span>

<span class="gp">In [63]: </span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">                      Out[63]: binomial(n, k)</span>

<span class="gp">In [64]: </span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">                                              Out[64]: gamma(x)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Calculus.html" class="btn btn-neutral float-right" title="2. 微积分与极限" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="《SymPy 笔记》前言" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, wklchris

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>