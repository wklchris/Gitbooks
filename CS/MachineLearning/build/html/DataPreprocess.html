

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. 数据预处理 &mdash; 机器学习笔记 0.1 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/rtd-revised.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="3. 线性回归" href="LinearRegression.html" />
    <link rel="prev" title="1. 基础" href="Basic.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> 机器学习笔记
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Basic.html">1. 基础</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Basic.html#id2">1.1. 为什么要学习机器学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basic.html#id3">1.2. 基础概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basic.html#id5">1.3. 机器学习的分类</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Basic.html#id6">1.3.1. 监督与无监督学习</a></li>
<li class="toctree-l3"><a class="reference internal" href="Basic.html#id7">1.3.2. 批量学习与在线学习</a></li>
<li class="toctree-l3"><a class="reference internal" href="Basic.html#id8">1.3.3. 基于实例/模型学习</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Basic.html#id9">1.4. 如何获取数据集</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. 数据预处理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">2.1. 补全缺失数据</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">2.1.1. 例1：用本特征的均值补全</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">2.1.2. 例2：用外部数据的众数补全</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">2.1.3. 例3：用给定常数补全</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">2.2. 数据类型处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">2.3. 拆分训练集与测试集</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">2.4. 特征缩放</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LinearRegression.html">3. 线性回归</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LinearRegression.html#id2">3.1. 误差</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearRegression.html#id3">3.2. 示例</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">机器学习笔记</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>2. 数据预处理</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/DataPreprocess.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="LinearRegression.html" class="btn btn-neutral float-right" title="3. 线性回归" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Basic.html" class="btn btn-neutral" title="1. 基础" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>2. 数据预处理<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>本章介绍数据预处理的内容。下例命令被提前运行：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="section" id="id2">
<h2>2.1. 补全缺失数据<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>缺失数据在不同数据集中可能有不同的标识方式，常见的列出如下。我个人倾向于使用 na，或者 N/A。个人不建议使用字符串“NaN”，因为这将与 pandas 默认的数字类型的 np.nan 混淆。</p>
<ul class="simple">
<li>未填写内容，或空格</li>
<li>N/A（或者 NA，na 等）</li>
<li>？（即问号符）</li>
<li>0，或所在特征（列）不可能取到的值（比如年龄属性中的负数）</li>
</ul>
<p>scikit-learn.impute 模块提供了：</p>
<ul class="simple">
<li>一个简单的缺失值估计器 <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">SimpleImputer</a> ，由用户指定估计策略。对于字符串类型的特征，可以用 <strong>众数</strong>  <cite>most_frequent</cite> 或 <strong>指定值</strong>  <cite>constant</cite> 来估计；对于数值类型的特征，除了上述两种策略外，还可以用 <strong>均值</strong>  <cite>mean</cite> 或者 <strong>中位数</strong>  <cite>median</cite> 来估计。</li>
<li>一个标记各元素是否为缺失值的标记器 <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.MissingIndicator.html">MissingIndicator</a> ，所有缺失位置会被标记为 True。注意：没有缺失值的特征（列）会被剔除。</li>
</ul>
<div class="section" id="id3">
<h3>2.1.1. 例1：用本特征的均值补全<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>方法 <cite>fit_transform</cite> 将本特征的数据用来拟合策略（本例中，即计算对应列除缺失值外的数据的均值）。例如对特征 x1 ，缺失值被估计为 <img class="math" src="_images/math/4a3c843d569acb98745979720d549af4b848e45e.svg" alt="(0+1+5)/3=2"/> 。本例中，所有 np.nan 被视为缺失值。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="gp">In [4]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">],</span>
<span class="gp">   ...: </span>                 <span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">   ...: </span>                 <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">   ...: </span>

<span class="gp">In [5]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">     y   x1   x2</span>
<span class="go">0    A  0.0  5.0</span>
<span class="go">1    B  1.0  NaN</span>
<span class="go">2    B  NaN  1.0</span>
<span class="go">3  N/A  5.0  9.0</span>

<span class="gp">In [6]: </span><span class="n">imp_mean</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">data_na_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="gp">In [8]: </span><span class="n">imp_mean</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_na_mean</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">array([[0., 5.],</span>
<span class="go">       [1., 5.],</span>
<span class="go">       [2., 1.],</span>
<span class="go">       [5., 9.]])</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>2.1.2. 例2：用外部数据的众数补全<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>用外部数据进行拟合（方法 <cite>fit</cite> ），再应用于当前数据集（方法 <cite>transform</cite>）。特征 y 中所有的“N/A”被补全为“D”，因为在外部数据中“D”的出现的频数与“E”同为最高，且排序在“E”之前。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">imp_freq</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">imp_freq</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_data</span><span class="p">)</span>
<span class="gh">Out[11]: </span><span class="go"></span>
<span class="go">SimpleImputer(copy=True, fill_value=None, missing_values=&#39;N/A&#39;,</span>
<span class="go">       strategy=&#39;most_frequent&#39;, verbose=0)</span>

<span class="gp">In [12]: </span><span class="n">imp_freq</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">                                                                                                                      Out[12]: </span>
<span class="go">array([[&#39;A&#39;],</span>
<span class="go">       [&#39;B&#39;],</span>
<span class="go">       [&#39;B&#39;],</span>
<span class="go">       [&#39;D&#39;]], dtype=object)</span>
</pre></div>
</div>
<p>需要注意的是，如果只应用到一列（或一行）数据，请记得使用 <cite>reshape(-1,1)</cite> （或 <cite>reshape(1,-1)</cite> ）命令。</p>
</div>
<div class="section" id="id5">
<h3>2.1.3. 例3：用给定常数补全<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>这是最简单的一种补全方式，方法上使用 <cite>fit_transform</cite> 即可。下例的所有缺失值被补全为 <img class="math" src="_images/math/4573612cf2dbb0a6f616956462b35592242f167d.svg" alt="-1"/> 。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">imp_constant</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">imp_constant</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x1</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gh">Out[14]: </span><span class="go"></span>
<span class="go">array([[ 0.],</span>
<span class="go">       [ 1.],</span>
<span class="go">       [-1.],</span>
<span class="go">       [ 5.]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>2.2. 数据类型处理<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>确认各特征的数据类型，例如是数字或是字符串。数据读取后请进行数据类型的检查。</p>
<p>此外，我们一般尽可能地使用数字来表示数据。比如性别男或女，可以处理为 0 或 1 来表示。如果你使用过 R 语言，那你应当对这样的 factor 类型处理不陌生。</p>
</div>
<div class="section" id="id7">
<h2>2.3. 拆分训练集与测试集<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p>将数据集随机打乱，然后抽取一定比例(一般70%～80%)作为训练集，剩下的作为测试集。</p>
</div>
<div class="section" id="id8">
<h2>2.4. 特征缩放<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<p>许多模型使用欧几里德距离作为一个重要的度量方式，这就导致多特征量模型中，特征的不同数值尺度会影响模型结果。为避免这一点，标准化是一种常用的预处理方法。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="LinearRegression.html" class="btn btn-neutral float-right" title="3. 线性回归" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Basic.html" class="btn btn-neutral" title="1. 基础" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, wklchris

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>