基础：安装 Ubuntu
====================

本章是快速引言，以及介绍如何安装 Ubuntu．主要分为三块：

* 在虚拟机上安装。对于初学者，推荐在虚拟机上安装。
* 在物理机上安装（单系统或双系统）
* 在 U 盘上安装便携式 Ubuntu 

不管使用哪一个方式，从 `Ubuntu 官方网站 <https://www.ubuntu.com/#download>`_ 下载 iso 虚拟光驱文件总是必要的。注意选择 Desktop 版本，以及带 LTS 的版本号——LTS 表示 Long Term Support，即长期支持版。 


在虚拟机上安装
----------------

我想点进这个页面的读者对虚拟机应当有过使用经验。作为一个 Windows 用户，我第一次接触 Linux 并不是在物理机上，而是在虚拟机上。我相信很多人与我有类似的经历。

在虚拟机上安装新的操作系统是一种很好的尝鲜方式，它的优点有：

* 随意折腾，而不会损坏物理机数据
* 避免了另买一台设备的开销，或者安装双系统会带来的种种问题
* 相当于试用；如果不满意，可以完全、干净地移除新系统

缺点当然也很明显：

* 性能受限，例如 CPU 与内存分配（在笔记本上尤为明显），以及显卡性能
* 虚拟机与主机交互带来的问题，比如共享剪贴板、共享文件、USB 设备识别，可能会耗费很多时间
* 系统的部分功能可能不能正常使用

废话不多说了，我们开始吧。

在 VM VirtualBox 上安装 Ubuntu
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

虚拟机软件上有很多选择，例如 `Oracle VM VirtualBox <https://www.virtualbox.org/>`_ 就是一款免费开源的虚拟机软件。本章节使用它作为示例，其他软件的设置大同小异。

值得指出的是，我建议读者下载对应 VirtualBox 版本对应的扩展包，以解决可能存在的 USB 设备识别问题。从官网的 `Older Builds <https://www.virtualbox.org/wiki/Download_Old_Builds>`_ 链接选择安装的版本，找到对应的 Extension Pack 进行下载即可。扩展包成功安装后，可以在 VirtualBox 主界面菜单的“管理 - 全局设定 - 扩展”中找到绿色勾选的扩展包。

为了安装 Ubuntu，我们需要新建一个虚拟机，分配给它 10 GB 或者更高的空间（Ubuntu 发行版越来越大了），然后分配给他足量的内存空间（我认为 4 GB 或更高？），结束新建。

完成新建，我们可以从主界面启动它。它会提示没有介质来启动，这时候我们可以选择之前下载的 iso 文件作为启动光盘，然后启动。

之后的过程与安装系统类似了，没有什么需要特别注意的地方。


在物理机上安装 Ubuntu
-------------------------

首要的准备工作是，准备一个空白的 U 盘，然后将 Ubuntu 的安装 iso 刻录进去制成启动盘。这一步可以利用 `Rufus <https://rufus.ie/>`_ 等软件。

安装单系统 Ubuntu，只需备份硬盘中的重要文件，然后重启。从启动 U 盘启动安装，格式化全盘，安装 Ubuntu。这一步骤相对简单。

安装双系统 Ubuntu 就需要小心了。我尝试过在 Windows 物理机上安装 Ubuntu，需要以下步骤：

* 划分一部分硬盘区域给 Ubuntu。“划分”的意思是从分区中删除，而不是格式化；Ubuntu 不能识别 Windows 格式化后的磁盘格式。如果你需要删除某一分区的一部分，你可能需要无损分区软件；当然了，请备份文件!
* 刻录 Ubuntu 安装 iso 到你的空白 U 盘。
* 重启 Windows，开机时按 Delete 进入你的 BIOS 设定，关闭以下项：

    * Fast Boot（快速启动）
    * Secure Boot（安全启动）：这一步也许不是必须的

* 请将 Ubuntu 按照你当前 Windows 同样的安装方式进行安装。如果当前是 UEFI，请继续使用该模式；如果是 Legacy，那么也继续使用它进行安装。总之，就是安装前不要改动这一项。

在 U 盘上安装便携式 Ubuntu
-----------------------------

.. danger::

   该方法不建议使用！极容易出现问题。

便携式操作系统从来就是一个美好的愿景，尽管它并不是总能实现。 

要在 U 盘上安装便携式 Ubuntu，请检查一下各项：

* 拥有一个 **空间足够** 而且 **读写速度较快** 的 U 盘：这一点非常重要。空间足够是因为 18.04 LTS 版本就要求了超过 8 GB 的空间，至少准备一个 16 GB 的 U 盘吧，更何况你还需要往里面装点别的。读写速度这条就更不用说了，这直接关系到便携系统的响应速度；你不会喜欢幻灯片式的 Ubuntu 的。如果你预算充足，一个便携式的 **固态**  U盘（或硬盘）是完美的选择。
* 安装一个虚拟机软件，或者持有一个启动设备。虚拟机软件可以让你从虚拟的启动环境中加载 Ubuntu 的安装 iso 文件，然后安装到你的 U 盘中。如果你不想使用虚拟机软件（因为这可能有些麻烦），你可以另选一个空白的 U 盘，将 iso 刻录到其中将它制成启动设备，然后重启你的物理机（插着两个U盘）来进行安装。如果你的物理机有光驱，你也可以刻录一张光盘。
* 充足的时间。安装便携式 Ubuntu 可能比常规在物理机上安装慢许多……当然，如果你使用了一个性能非常好的 U 盘，那就忽略这条吧。

我在安装便携 Ubuntu 系统时，使用的是 16 GB 的 U 盘与 VM VirtualBox 虚拟机软件。流程如下：

1. 新建一个虚拟机，分配 4 GB 内存与 2 核来保证性能， **避免安装时卡顿** 。硬盘大小并不重要，因为系统并不会装在虚拟机上。
2. 插入 U 盘，主机识别。确认 U 盘中没有重要文件。
3. 在虚拟机的“设置 - USB 设备”中启用恰当的 USB 控制器，比如我的笔记本上是 USB 3.0.
4. 如果下方“USB 设备筛选器”中没有显示 U 盘，请从右侧带绿色加号的按钮，新建一个与主机现有 USB 设备参数相同的筛选器，并选择 主机上的这块 U 盘作为参照目标。
5. 在虚拟机的“设置 - 存储 - 控制器 IDE”中，找到 Ubuntu 系统的安装 iso 文件，作为启动光盘。
6. 设置完毕。启动虚拟机。
7. 在上方的“设备 - USB”中应当可以看到 U 盘被虚拟机识别（打钩）。在这一步，U 盘会自动从主机断开，并连接到启动的虚拟机。这一步在实际操作中是最容易出现问题的，如有问题请依次检查：
   
    * 是否安装了 VM VirtualBox 当前版本对应的扩展包（参考上文）
    * USB 设备筛选器是否选择了正确的设备
    * 如仍不行，请在启动虚拟机前从主机弹出 U 盘，不要拔出，然后启动虚拟机，并尝试从“设备 - USB”菜单中勾选 U 盘。

8. 出现安装界面，一路继续，直到选择安装位置时选择 U 盘，并令其擦除全盘进行安装（最简单的方式）。
9. 设置用户名与密码，进入安装。
10. 等待安装完成。我大约花费了 30 分钟的时间。
11. 提示安装完成可以重启时，点击重启，并 **在虚拟机启动界面按 F12 以进入 boot menu** ，选择从 U 盘启动。
12. Ubuntu 成功启动。可以安装必要的软件与更新了。
13. 关机，弹出 U 盘。然后在主机上进行从 U 盘启动 Ubuntu 的测试。

如果使用额外的 U 盘而不是虚拟机来进行安装，风险更高。在疑难解答一章中，我回答了几个在该步骤中常见的问题。

